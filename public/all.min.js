"use strict";var app=angular.module("swDictionary",["ngRoute","ngMaterial","ngAria","ngMessages"]).config(["$locationProvider","$routeProvider",function(e,t){e.hashPrefix("!"),t.otherwise({redirectTo:"/404"})}]),swapiModule=function(){function e(e,t){function i(e){if(4==n.readyState||"load"===e.type){if(n.status&&200!=n.status)throw"Error loading data: "+n.status;t(JSON.parse(n.responseText))}}var n;window.XDomainRequest?(n=new XDomainRequest,n.open("get",e,!0),n.timeout=3e4):(n=new XMLHttpRequest,n.open("get",e,!0),n.setRequestHeader("Accept","application/json")),n.onload=i,setTimeout(function(){n.send()},0)}function t(t){e(r,t)}function i(t){return function(i,n){e(r+t+"/"+i+"/",n)}}function n(t){return function(){1===arguments.length?e(r+t+"/",arguments[0]):e(r+t+"/?page="+arguments[0],arguments[1])}}var r="http://swapi.co/api/";return{getResources:t,getPerson:i("people"),getPeople:n("people"),getFilm:i("films"),getFilms:n("films"),getPlanet:i("planets"),getPlanets:n("planets"),getSpecies:i("species"),getAllSpecies:n("species"),getStarship:i("starships"),getStarships:n("starships"),getVehicle:i("vehicles"),getVehicles:n("vehicles")}}();app.directive("detailsFilm",function(){return{restrict:"E",templateUrl:"../templates/components/details-film.html",scope:{film:"<"}}}),app.directive("detailsPerson",function(){return{restrict:"E",templateUrl:"../templates/components/details-person.html",scope:{person:"<"}}}),app.directive("detailsPlanet",function(){return{restrict:"E",templateUrl:"../templates/components/details-planet.html",scope:{planet:"<"}}}),app.directive("detailsSpecies",function(){return{restrict:"E",templateUrl:"../templates/components/details-species.html",scope:{species:"<"}}}),app.directive("detailsStarship",function(){return{restrict:"E",templateUrl:"../templates/components/details-starship.html",scope:{starship:"<"}}}),app.directive("detailsVehicle",function(){return{restrict:"E",templateUrl:"../templates/components/details-vehicle.html",scope:{vehicle:"<"}}}),app.directive("layout",function(){return{transclude:!0,restrict:"E",templateUrl:"../templates/components/layout.html"}}),app.directive("loading",function(){return{restrict:"E",template:'<div class="spinner"/>'}}),app.directive("searchItem",function(){return{restrict:"E",templateUrl:"../templates/components/search-item.html",scope:{item:"<"}}}),app.directive("searchResults",function(){return console.log("search results"),{restrict:"E",templateUrl:"../templates/components/search-results.html",scope:{items:"<"}}}),app.service("dataTypes",function(){this.types={person:{title:"Person",key:"people",icon:"account"},film:{title:"Film",key:"films",icon:"movie"},planet:{title:"Planet",key:"planets",icon:"globe"},species:{title:"Species",key:"species",icon:"walk"},starship:{title:"Starship",key:"starships",icon:"airplane"},vehicle:{title:"Vehicle",key:"vehicles",icon:"directions-car"}},this.isValidDataType=function(e){for(var t in this.types){var i=this.types[t].title;if(i.toLowerCase()===e.toLowerCase())return!0}return!1}}).service("fetchData",["dataTypes",function(e){function t(e){return e.id=c(a.person.key,e.url),e.type=a.person.title,e.title=e.name,e.icon=a.person.icon,e.searchText=[e.name,e.type].join(""),e}function i(e){return e.id=c(a.film.key,e.url),e.type=a.film.title,e.icon=a.film.icon,e.searchText=[e.director,e.producer,e.title,e.type].join(""),e}function n(e){return e.id=c(a.planet.key,e.url),e.type=a.planet.title,e.title=e.name,e.icon=a.planet.icon,e.searchText=[e.climate,e.name,e.terrain,e.type].join(""),e}function r(e){return e.id=c(a.species.key,e.url),e.type=a.species.title,e.title=e.name,e.icon=a.species.icon,e.searchText=[e.classification,e.designation,e.language,e.name,e.skin_colors,e.type].join(""),e}function s(e){return e.id=c(a.starship.key,e.url),e.type=a.starship.title,e.title=e.name,e.icon=a.starship.icon,e.searchText=[e.manufacturer,e.model,e.name,e.type].join(""),e}function o(e){return e.id=c(a.vehicle.key,e.url),e.type=a.vehicle.title,e.title=e.name+" - "+e.model,e.icon=a.vehicle.icon,e.searchText=[e.name,e.model].join(""),e}function c(e,t){var i=new RegExp("https?://swapi.co/api/"+e+"/(\\d*)/").exec(t);return Array.isArray(i)?i[1]:null}var a=e.types;this.getAll=function(){var e=this.getPeople(),t=this.getFilms(),i=this.getPlanets(),n=this.getAllSpecies(),r=this.getStarships(),s=this.getVehicles();return Promise.all([e,t,i,n,r,s]).then(function(e){var t=[].concat(e.shift(),e.shift(),e.shift(),e.shift(),e.shift(),e.shift());return t})},this.getPerson=function(e){return new Promise(function(i,n){try{swapiModule.getPerson(e,function(e){i(t(e))})}catch(r){n(r)}})},this.getPeople=function(){return new Promise(function(e,i){swapiModule.getPeople(function(n){try{var r=n.results,s=r.map(function(e){return t(e)});e(s)}catch(o){i(o)}})})},this.getFilm=function(e){return new Promise(function(t,n){try{swapiModule.getFilm(e,function(e){t(i(e))})}catch(r){n(r)}})},this.getFilms=function(){return new Promise(function(e,t){try{swapiModule.getFilms(function(t){var n=t.results,r=n.map(function(e){return i(e)});e(r)})}catch(n){t(n)}})},this.getPlanet=function(e){return new Promise(function(t,i){try{swapiModule.getPlanet(e,function(e){t(n(e))})}catch(r){i(r)}})},this.getPlanets=function(){return new Promise(function(e,t){try{swapiModule.getPlanets(function(t){var i=t.results,r=i.map(function(e){return n(e)});e(r)})}catch(i){t(i)}})},this.getSpecies=function(e){return new Promise(function(t,i){try{swapiModule.getSpecies(e,function(e){t(r(e))})}catch(n){i(n)}})},this.getAllSpecies=function(){return new Promise(function(e,t){swapiModule.getAllSpecies(function(i){try{var n=i.results,s=n.map(function(e){return r(e)});e(s)}catch(o){t(o)}})})},this.getStarship=function(e){return new Promise(function(t,i){try{swapiModule.getStarship(e,function(e){t(s(e))})}catch(n){i(n)}})},this.getStarships=function(){return new Promise(function(e,t){try{swapiModule.getStarships(function(t){var i=t.results,n=i.map(function(e){return s(e)});e(n)})}catch(i){t(i)}})},this.getVehicle=function(e){return new Promise(function(t,i){try{swapiModule.getVehicle(e,function(e){t(o(e))})}catch(n){i(n)}})},this.getVehicles=function(){return new Promise(function(e,t){try{return swapiModule.getVehicles(function(t){var i=t.results,n=i.map(function(e){return o(e)});e(n)})}catch(i){t(i)}})}}]),app.config(["$routeProvider",function(e){e.when("/:type/:id",{templateUrl:"../templates/views/details.html",controller:"DetailsCtrl"})}]).controller("DetailsCtrl",["$routeParams","$scope","dataTypes","fetchData",function(e,t,i,n){t.error=!1,t.item={},t.isValidDateType=!0;var r=e.type,s=e.id,o=i.isValidDataType(r);if(o&&s){var c="get"+r;try{n[c](s).then(function(e){console.log(e),t.item=e,t.$apply()})["catch"](function(){console.log("error 2"),t.error=!0,t.$apply()})}catch(a){console.log("error"),t.error=!0,t.$apply()}}else t.isValidDateType=!1}]),app.config(["$routeProvider",function(e){e.when("/",{templateUrl:"../templates/views/home.html",controller:"HomeCtrl"})}]).controller("HomeCtrl",["$scope","fetchData",function(e,t){function i(){var t=e.search.text.toLowerCase();t?e.search.items=n.filter(function(e){return e.searchText.toLowerCase().indexOf(t)>-1}):e.search.items=[]}var n=[];e.loading=!0,e.search={selected:"",text:"",items:[],run:i},t.getAll().then(function(t){n=t,e.loading=!1,e.$apply()})}]),app.config(["$routeProvider",function(e){e.when("/404",{templateUrl:"../templates/views/not-found.html",controller:"ViewNotFoundCtrl"})}]).controller("ViewNotFoundCtrl",[function(){}]);